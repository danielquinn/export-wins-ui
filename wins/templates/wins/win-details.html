{% extends 'ui/base.html' %}

{% load staticfiles %}

{% block css %}
  {{ block.super }}
  <style>
    .field {
      margin-bottom: 1em;
    }
    .name {
      font-weight: bold;
    }
    .value {

    }
  </style>
{% endblock css %}

{% block breadcrumb-name %}View win{% endblock %}
{% block header %}View win{% endblock header %}

{% block content %}

{% comment %}
'hq_team': 'team:1',
'updated': '2016-08-04T14:49:27.046950Z',
'description': 'my company supported',
'customer_email_address': 'my@email.com',
'location': '',
'id': 'ecfce1b9-9d35-42ca-93f2-358041f8504b',
'other_official_email_address': '',
'customer_location': 3,
'is_e_exported': True,
'name_of_customer': 'overseas',
'country': 'AS',
'date': '2016-07-01',
'is_line_manager_confirmed': True,
'name_of_export': 'good exported',
'type_of_support_1': 2,
'company_name': 'my company',
'user': 2,
'associated_programme_1': None,
'lead_officer_email_address': '',
'lead_officer_name': 'graham',
'hvo_programme': '',
'is_personally_confirmed': True,
'created': '2016-08-03T13:54:16.822080Z',
'responded': None,
'business_type': 'my business deal',
'associated_programme_3': None,
'goods_vs_services': 3,
'line_manager_name': 'my manager',
'type': 2,
'total_expected_export_value': 10000,
'associated_programme_2': None,
'team_type': 'team',
'type_of_support_3': None,
'total_expected_non_export_value': 10000,
'has_hvo_specialist_involvement': True,
'customer_job_title': 'my job',
'sector': 2,
'complete': True,
'cdms_reference': '123423423',
'is_prosperity_fund_related': True,
'customer_name': 'my contact',
'sent': ['2016-08-04T14:49:27.052Z'],
'type_of_support_2': None}
{% endcomment %}


  <div class="win-details">

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="h4">Customer details</h3>
      </div>
      <div class="panel-body">
        <p>
          <span class="sr-only">Company:</span><span class="company-name">{{ win.company_name }}</span> <span class="small text-muted">(CDMS Id: {{ win.cdms_reference }})</span><br>
          Location: {{ win.customer_location }}
        </p>
        <p>
          <span class="sr-only">Name:</span><span class="customer-name">{{ win.customer_name }}</span>
          <span class="sr-only">Job title:</span><span class="text-muted">({{ win.customer_job_title }})</span><br>
          <span class="glyphicon glyphicon-envelope"></span><span class="sr-only">Email:</span>{{ win.customer_email_address }}
        </p>
      </div>
    </div>


    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="h4">Lead officer details</h3>
      </div>
      <div class="panel-body">
        <p>
          <span class="sr-only">Name:</span><span class="customer-name">{{ win.lead_officer_name }}</span>
         
          {% if win.lead_officer_email_address %}
          <span class="officer-email">
            <span class="glyphicon glyphicon-envelope"></span><span class="sr-only">Email:</span>{{ win.lead_officer_email_address }}
          </span>
          {% endif %}

          {% if win.other_official_email_address %}
          <span class="glyphicon glyphicon-envelope"></span><span class="sr-only">Other Email:</span>{{ win.other_official_email_address }}
          {% endif %}
        </p>

        <p>
          Line manager: {{ win.line_manager_name }} <br>
          Team: {{ win.team_type }} <br>
          HQ Team/Region/Post: {{ win.hq_team }} <br>
          Location: {{ win.location }}
        </p>
      </div>
    </div>


    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="h4">Contributing teams and advisers</h3>
      </div>
      <div class="panel-body">

            {% if win.advisors %}

              <table id="advisors" class="advisors table table-responsive">
              <tr>
                <th>Name</th>
                <th>Team Type</th>
                <th>HQ Team<br />Region or Post</th>
                <th>Location</th>
              </tr>
              {% for advisor in win.advisors %}
                <tr class="advisor">
                  <td>{{ advisor.name }}</td>
                  <td class="team-type">{{ advisor.team_type }}</td>
                  <td class="team-hq_team">{{ advisor.hq_team }}</td>
                  <td>{{ advisor.location }}</td>
                </tr>
              {% endfor %}
            </table>

            {% else %}

              <p class="text-center">
                No contributing teams and advisers.
              </p>

            {% endif %}
      </div>
    </div>

    <hr>

    <h3>Details of Export Win</h3>
    
    <div class="row">
      <div class="col-sm-6">
        {% include "wins/win-details-element.html" with name="Date won" val=win.date %}
      </div>
      <div class="col-sm-6">
        {% include "wins/win-details-element.html" with name="Country" val=win.country %}
      </div>
    </div>
    
    {% include "wins/win-details-element.html" with name="Business deal that best describes the win" val=win.business_type %}
    {% include "wins/win-details-element.html" with name="How the company was supported in achieving the win" val=win.description %}
    {% include "wins/win-details-element.html" with name="Name of their overseas customer" val=win.name_of_customer %}
    {% include "wins/win-details-element.html" with name="Goods or services that are being exported" val=win.name_of_export %}

    <hr>

    <h3>Expected value of the win</h3>

    {% include "wins/win-details-element.html" with name="Type" val=win.type %}

    <h4>Export value</h4>

    <p>
      Total export value over the next 5 years.
    </p>

    <div class="row">
      <div class="col-sm-6">
        <ol class="export-value-group">
          <li class="export-value-item first">
            <span class="export-year">{{ win.breakdowns.exports.0.year }}</span>
            <span class="export-year-value">&pound;{{ win.breakdowns.exports.0.value }}</span>
          </li>
          <li class="export-value-item">
            <span class="export-year">{{ win.breakdowns.exports.1.year }}</span>
            <span class="export-year-value">&pound;{{ win.breakdowns.exports.1.value }}</span>
          </li>
          <li class="export-value-item">
            <span class="export-year">{{ win.breakdowns.exports.2.year }}</span>
            <span class="export-year-value">&pound;{{ win.breakdowns.exports.2.value }}</span>
          </li>
          <li class="export-value-item">
            <span class="export-year">{{ win.breakdowns.exports.3.year }}</span>
            <span class="export-year-value">&pound;{{ win.breakdowns.exports.3.value }}</span>
          </li>
          <li class="export-value-item">
            <span class="export-year">{{ win.breakdowns.exports.4.year }}</span>
            <span class="export-year-value">&pound;{{ win.breakdowns.exports.4.value }}</span>
          </li>
          <li class="export-value-item last">
            <span class="export-year">Total</span>
            <span class="export-year-value">&pound;{{ win.total_expected_export_value }}</span>
          </li>
         </ol>
      </div>
    </div>

    {% include "wins/win-details-element.html" with name="Does the expected export value relate to goods or services" val=win.goods_vs_services %}
    {% include "wins/win-details-element.html" with name="Sector" val=win.sector %}

    <h4>Non-export value</h4>

    {% include "wins/win-details-element.html" with name="Total expected non-export value" val=win.total_expected_non_export_value %}

    {# this should show all 5 years even if we don't have data... #}
    <table class="table table-responsive">
      <tr>
        <th>{{ win.breakdowns.non_exports.0.year }}</th>
        <th>{{ win.breakdowns.non_exports.1.year }}</th>
        <th>{{ win.breakdowns.non_exports.2.year }}</th>
        <th>{{ win.breakdowns.non_exports.3.year }}</th>
        <th>{{ win.breakdowns.non_exports.4.year }}</th>
      </tr>
      <tr>
        <td>{{ win.breakdowns.non_exports.0.value }}</td>
        <td>{{ win.breakdowns.non_exports.1.value }}</td>
        <td>{{ win.breakdowns.non_exports.2.value }}</td>
        <td>{{ win.breakdowns.non_exports.3.value }}</td>
        <td>{{ win.breakdowns.non_exports.4.value }}</td>
      </tr>
    </table>

    <hr />


    <h3>Support provided</h3>


    {% include "wins/win-details-element.html" with name="HVO Programme, if applicable" val=win.hvo_programme required=False %}
    {% include "wins/win-details-element.html" with name="Have HVO Specialists been involved" val=win.has_hvo_specialist_involvement %}
    {% include "wins/win-details-element.html" with name="Is this win Prosperity Fund related" val=win.is_prosperity_fund_related %}
    {% include "wins/win-details-element.html" with name="Does the win relate to e-exporting" val=win.is_e_exported %}
    {% include "wins/win-details-element.html" with name="Type of support 1" val=win.type_of_support_1 %}
    {% include "wins/win-details-element.html" with name="Type of support 2" val=win.type_of_support_2 required=False %}
    {% include "wins/win-details-element.html" with name="Type of support 3" val=win.type_of_support_3 required=False %}
    {% include "wins/win-details-element.html" with name="Associated programme 1" val=win.associated_programme_1 required=False %}
    {% include "wins/win-details-element.html" with name="Associated programme 2" val=win.associated_programme_2 required=False %}
    {% include "wins/win-details-element.html" with name="Associated programme 3" val=win.associated_programme_3 required=False %}

    <hr />

    {% include "wins/win-details-element.html" with name="I confirm that the information above is complete and accurate" val=win.is_personally_confirmed %}
    {% include "wins/win-details-element.html" with name="My line manager has confirmed the decision to record this win" val=win.is_line_manager_confirmed %}

    <a href="{% url 'win-edit' win.id %}" class="btn btn-primary">edit</a>
    <a href="{% url 'win-complete' win.id %}" class="btn btn-primary">send</a>

  </div>

{% endblock content %}
